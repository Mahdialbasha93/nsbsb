name: Discord Server Cloner Bot

on:
  workflow_dispatch:  # Manual trigger only
    inputs:
      run_mode:
        description: 'Run mode'
        required: true
        default: 'start'
        type: choice
        options:
          - start
          - stop

jobs:
  run-bot:
    runs-on: ubuntu-latest
    
    steps:
    - name: üöÄ Checkout code
      uses: actions/checkout@v3
    
    - name: üì¶ Setup Node.js
      uses: actions/setup-node@v3
      with:
        node-version: '18'
        cache: 'npm'
    
    - name: üì• Install dependencies
      run: npm ci
    
    - name: üîë Setup environment
      run: |
        echo "TOKEN=${{ secrets.DISCORD_TOKEN }}" >> .env
        echo "ALLOWED_USER_IDS=${{ secrets.ALLOWED_USER_IDS }}" >> .env
        echo "DISCORD_TOKEN=${{ secrets.DISCORD_TOKEN }}" >> .env
    
    - name: üèÉ Run Server Cloner Bot
      env:
        TOKEN: ${{ secrets.DISCORD_TOKEN }}
        ALLOWED_USER_IDS: ${{ secrets.ALLOWED_USER_IDS }}
      run: |
        echo "=========================================="
        echo "üöÄ Starting Discord Server Cloner Bot..."
        echo "ü§ñ Bot will now listen for !clone commands"
        echo "=========================================="
        echo ""
        echo "üìã Bot Information:"
        echo "‚Ä¢ Auto-Reconnect: Enabled"
        echo "‚Ä¢ Max Reconnects: 3"
        echo "‚Ä¢ Slow Threshold: 30 seconds"
        echo "‚Ä¢ Emoji Delay: 2 seconds"
        echo ""
        echo "üìù Available Commands:"
        echo "!clone <sourceID> <targetID> - Clone server"
        echo "!help - Show help information"
        echo "!status - Check bot status"
        echo ""
        echo "=========================================="
        
        # Run the bot
        node index.js
